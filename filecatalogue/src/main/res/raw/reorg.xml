<sql>
    <statement>
        delete from POS_PRODUCT_REL
        where not exists (select 1 from POS_PRODUCT
        where POS_PRODUCT._id = POS_PRODUCT_REL._productid)
    </statement>
    <statement>
        delete from pos_orderline
        where not exists (select 1 from POS_PRODUCT
        where POS_PRODUCT._id = pos_orderline._productid)
    </statement>
    <statement>
        delete from pos_category where type = 2 and level = 2
        and not exists(select 1 from POS_PRODUCT
        where POS_PRODUCT._categoryid = pos_category._id)
    </statement>
    <statement>
        update pos_category set _mainid = 0
        where level = 1 and _id = _mainid
    </statement>
    <statement>
        update POS_HELP set Description = "" where Description="null"
    </statement>
    <statement>
        update POS_HELP set Description = header where Description=""
    </statement>
    <statement>
        delete from pos_product_rel where not exists ( select 1 from pos_category
        where pos_category._id = pos_product_rel._categoryid)
    </statement>
    <statement>
        delete from pos_product_rel
        where exists (
        select _productid, _categoryid
        from pos_product_rel sub
        where pos_product_rel._productid = sub._productid
        and pos_product_rel._categoryid = sub._categoryid
        AND pos_product_rel.rowid &lt; sub.rowid )
    </statement>
    <statement>
        delete from pos_category where type = 2 and level = 1 and _mainid = 0 and _id &gt; 10
    </statement>

    <statement>
        delete from pos_product_rel
        where _productid in (
        select _id
        from pos_product
        where type = 3 and filename like '%.csv')
    </statement>

    <statement>
        delete from pos_product
        where type = 3 and filename like '%.csv'
    </statement>

    <statement>
        delete FROM pos_product_rel
        where _productid in (
        select _id  FROM pos_product
        where exists (select 1
        FROM  pos_product sub
        WHERE pos_product.filename = sub.filename
        AND   pos_product.dirname = sub.dirname
        AND   pos_product.rowid &lt; sub.rowid ))
    </statement>
    <statement>
        delete FROM pos_product
        where exists (select 1
        FROM  pos_product sub
        WHERE pos_product.filename = sub.filename
        AND   pos_product.dirname = sub.dirname
        AND   pos_product.rowid &lt; sub.rowid )
    </statement>
    <statement>
        update pos_product set rotation =  0
        where rotation is null and type = 3
    </statement>

    <statement>
        DROP TABLE IF EXISTS pos_face
    </statement>
    <statement>
        DROP TABLE IF EXISTS pos_faceextra
    </statement>

    <statement>
        CREATE TABLE IF NOT EXISTS pos_face (
        _id 		  INTEGER PRIMARY KEY AUTOINCREMENT,
        _categoryid   INTEGER NOT NULL,
        _productid 	  INTEGER NOT NULL,
        seqno         INTEGER DEFAULT 0,
        spoof 	      INTEGER DEFAULT 0,
        distance      NUMERIC(6,2),
        extra	      VARCHAR(10000))
    </statement>

    <statement>
        delete from pos_face
    </statement>

    <statement>
        insert into pos_face ( _id, _categoryid, distance, seqno,_productid, extra) values(1,23,-1.0, 1,0, '0.0012088382,0.013637316,0.0058335536,-0.016960062,0.0042900788,0.08206754,-0.016081916,-0.038708776,-0.096204564,-0.113167025,-0.005927247,0.003826447,0.002772102,0.005535417,0.0028125327,0.048491035,0.008818385,-0.0024205078,-0.002026601,-0.0101094395,0.0813978,-0.012624766,-0.12168357,-0.002549224,0.11757026,0.0018895383,-0.0020483441,-0.07884813,-0.015712978,0.18324214,-0.0033613562,-0.27555904,-0.02515615,-0.00027497756,-0.10088068,-0.16524327,-0.0451399,0.020213056,-0.0075504994,0.30724296,-0.0010007889,-0.002209889,0.0036588255,-0.0062720766,-0.0058507477,-0.021689367,0.13110171,-0.06543571,-0.0020546087,0.08365614,0.20112407,-0.0012519155,0.024360353,-0.002919266,-0.0148404585,-0.006403105,0.048341583,-0.0011437059,0.034501888,0.0015972821,0.0094709415,-0.018225526,0.12140382,0.21803664,0.0089695845,0.12108141,-0.00066284643,-0.0011619998,-0.008856169,0.002985514,0.003230183,-0.072180696,-0.019903107,0.0052118865,-0.010512113,0.004738561,0.008071663,0.0010155404,0.12203402,0.11020909,0.0030019614,0.073334,0.0007588845,0.09343206,-0.060055986,0.0021258995,-0.0012707582,0.09425051,-0.032604665,0.25807947,-0.029772112,-0.0009827386,-0.012413681,0.005126398,0.060164455,-0.08349406,0.045975644,0.30245435,0.0034652422,-0.0021927739,0.0026638438,0.0020501541,0.0017754716,0.0042836117,0.0051348973,0.007079766,0.106335334,-0.008287125,-0.014739476,-0.006934804,0.1927914,0.0041297125,-0.008259611,-0.08944897,0.009221205,0.15978445,-0.016092308,0.011745133,-0.03557591,0.012804256,0.18382084,-0.00088225945,0.14205563,0.0008057799,-0.00026630113,-0.00687152,0.010842242,0.0058877966,0.004020981,0.100962386,-9.8293785E-05,-0.011061236,-0.003956295,-0.059844285,0.10857096,-0.0077340547,0.08321437,0.043265905,0.0037336405,0.008132408,-0.005321283,-0.006414982,0.0035780335,-0.007141939,0.011256672,0.009212981,0.010672865,0.013813206,0.0032904241,0.013193207,-0.00761502,0.10651453,0.053357173,-0.0010698764,0.0055317525,-0.012654526,0.011915488,0.015342505,0.044688996,-0.0027807942,0.012687887,0.0035159823,-0.010070599,-0.0013802708,-0.009039462,-0.0051479465,-0.0017719793,-0.010806726,-0.00039553957,0.0033680322,0.090447366,0.020136716,-0.0018443998,-0.07302566,0.034657877,-0.00019442952,-0.031766105,0.05740181,0.0015148896,-0.0026186223,-0.18495683,-0.0014626852,0.0034759967,0.0017318458,0.08363127,-0.08559134,0.04628466,-0.0035001866,0.14107674,-0.11934653,0.015833389,0.004985631' )
    </statement>
    <statement>
        insert into pos_face ( _id, _categoryid, distance, seqno,_productid, extra) values(2,23,-1.0, 2,0, '-0.022185078,0.032150064,0.010666219,-0.010101806,-0.051457137,0.009512638,-0.03870976,0.21727419,-0.11508681,-0.05829203,-0.015150072,0.011578255,-0.003925085,0.04274048,4.092365E-4,-0.003096132,-0.013297757,-0.0077387337,-0.0011217208,-0.0071288873,-0.027634611,0.07698926,0.004521982,0.0037394292,-0.004675865,0.009772778,-0.042498093,0.09500629,0.09872892,-0.16034998,-0.008679439,0.094282195,-0.028508078,0.002837483,-0.07340054,0.0014286228,-0.003518885,-0.015484002,0.0015277667,-0.0015281973,0.0010900685,0.0022998557,0.0117624365,-0.0068890993,0.0020104463,-0.03767206,-0.12587301,-0.05684885,-0.0013846003,0.028892202,0.17908211,-0.00377238,-0.15795465,4.6958978E-4,-0.022258561,0.016471315,-0.0013900421,0.0033273986,-0.0804744,0.029612562,0.048565194,-0.06256597,0.08901957,0.0059125437,-0.0030787217,0.117481105,-0.0057680616,0.007746404,7.868147E-4,0.0014276205,-0.027536973,-0.042507913,0.030136015,0.008058709,-0.10145637,0.014199616,0.006037253,0.003449648,0.18254542,0.19142953,-0.0061272103,-0.011032244,-0.017377853,0.16151866,-0.11375758,-0.002120914,0.005198679,0.10923549,0.047089595,-0.18588166,0.048753668,-0.0015193521,0.0015740818,-0.023187183,-0.016668264,-0.061133992,-0.037751675,-0.120760724,-2.8119358E-4,9.143966E-5,0.0017084634,-0.010104053,-0.0056829513,-0.0054288213,-0.0054728803,0.004289467,-0.14297777,-0.003140544,0.008799775,0.0052987714,-0.15532692,0.009542631,0.010250256,0.16611448,0.01488274,0.17162624,-0.014776283,-0.035510253,0.043955952,0.1799352,0.18446569,0.015598256,-0.021790143,0.0021827887,0.0018564777,-0.0010596882,0.008970073,0.0043498594,0.007982816,-0.13724507,0.013330531,0.013814495,-0.0028180045,0.0412101,0.11566947,-0.014447392,-0.19116804,-0.049045082,0.0042113974,0.01651495,-0.01236717,-0.0014484151,0.0074453694,-0.041880094,-0.14267267,-0.06025621,-0.005502667,0.0051641385,0.006434432,-0.011948021,-0.004206382,-0.04027248,0.03485357,-0.022157928,-0.0084990235,-0.005266751,0.010703048,0.0056304904,0.015180067,-0.005422056,-0.0579336,0.0017287028,-0.011669815,0.0020652264,0.004406579,0.022671876,0.03081758,-0.3377817,-0.0023125787,-2.1384226E-6,0.15072925,0.018359931,-0.003229376,-0.15009864,-0.028937206,0.0041977596,-0.123514116,-0.08517901,-0.012148764,0.008713434,-0.21725196,-0.0134708565,0.0019884957,-0.006768252,-0.029411875,0.06486262,-0.089882165,0.10401906,-0.06266267,-0.06717233,-0.06352871,-0.006787643' )
    </statement>

    <statement>
        insert into pos_face ( _id, _categoryid, distance, seqno,_productid, extra) values(3,22,-1.0, 1,0,'-0.01655962,0.024684757,0.012092028,-0.0019911116,-0.04095503,-0.0023791173,-0.084701315,0.24029203,-0.14920232,0.090414405,-0.014931477,0.013776914,-0.004970804,0.030088525,0.0010983138,0.08024934,-0.01961098,-0.006111218,-0.0023318324,-0.0044107893,-0.009153331,0.054633122,0.004123769,0.0054423143,0.017679648,0.0076406104,-0.03828654,0.06343322,0.14153615,-0.089984916,-0.01762225,0.03634613,-0.09616188,9.4320596E-4,-0.02036744,0.014458434,0.010956695,-0.015649542,0.0060895616,-0.1834886,6.4880407E-4,0.0024194769,0.012058947,-0.010363896,0.009621323,-0.042612888,-0.0616373,-0.06445123,0.0015193345,-0.018491501,0.16186495,-0.00212952,-0.11638902,3.2428343E-5,-0.08781034,0.014860322,-0.018290365,0.0022424636,-0.06914195,0.020474236,0.04857716,-0.010186698,0.07166965,0.02978237,-0.0068021305,0.16213334,-0.006710924,0.016937403,0.005079285,0.0027794184,-0.028351227,-0.03559172,0.16141202,0.005146591,-0.16224524,0.005845963,0.009763537,0.0018597017,0.23006743,0.17219709,-0.007725359,-0.033285014,-0.008223297,-0.015302939,-0.14802949,-0.0036743192,0.0014434587,0.13471076,0.019735951,-0.19425415,-0.04249621,-0.003554665,0.006439486,-0.012990989,-0.002747191,-0.1356254,0.0023670874,-0.1096247,-0.0026188325,-9.126862E-4,0.0018681106,-0.017350424,-0.0038713973,-0.0055792406,-0.0022042552,0.007676054,-0.13229358,3.155044E-5,-0.0013921852,0.0012517975,-0.15517594,0.0025378468,0.011801625,0.13589808,0.009300719,0.21613204,-0.0122771785,-0.017182983,0.017027663,0.13320121,0.14505525,0.022628088,-0.14505088,0.0013413217,0.0042215427,-0.003374565,0.006489193,-0.0023717696,0.008574067,-0.075945556,0.012940112,0.009801209,-0.002915481,0.051805478,0.05862593,-0.011343306,-0.15105556,-0.068054356,0.01206513,0.009257619,-0.011121523,-0.0011984697,0.008020695,0.014768706,-0.120139115,0.016665012,-0.011973244,-8.217324E-4,-0.0021032202,-0.0068191006,-0.0058764312,-0.10097476,0.20932947,-0.018185275,-0.00898134,-0.00491568,0.007486883,-2.390347E-4,-0.095359184,-0.005065124,-0.048866928,0.0016152181,-0.010659926,0.0026343435,0.0025325387,0.020489478,0.030229287,-0.20355734,-0.00247043,-0.0033264167,0.1752093,-0.0035110714,-0.006160993,-0.15274256,-0.036058847,0.0017272119,-0.112427846,-0.06741054,-0.009908759,0.009070991,-0.13376985,-0.041587137,-0.006040283,-0.0058892304,-0.057663944,-3.3041078E-4,-0.11754256,0.11648648,-0.05308701,-0.02188512,-0.058341447,-0.009606171' )
    </statement>
    <statement>
        insert into pos_face ( _id, _categoryid, distance, seqno,_productid, extra) values(4,22, -1.0, 2,0,'-0.009990529,0.0143571915,0.0156964,0.0019044622,-0.029390559,0.09646102,-0.17540324,-0.033156324,-0.07948402,0.093613185,-0.013753563,0.006478642,0.0029106075,0.009238765,0.0066144103,0.07016139,-0.014900294,2.3508866E-4,-0.00877002,0.009021801,0.20281905,0.008027782,0.05081701,0.0020648807,0.0117836045,-0.0057662814,-0.023088519,0.02506604,-0.124758236,0.2387148,-0.005612353,-0.19663294,-0.10629085,-0.0024981666,0.10049213,0.19316433,-0.09885569,-4.1708554E-4,-5.845316E-4,-0.2197417,-0.0014605009,0.0015090626,0.005433769,-0.0072139455,0.0014090235,-0.030483361,0.23553571,-0.08208067,-0.0031845754,0.04646197,0.18985601,0.0021642728,-0.039938364,1.2705865E-4,-0.13814126,-0.00500118,-0.11893362,-2.4966133E-4,-0.01824283,0.011575135,0.0092552705,-0.017502937,-0.004455453,-0.10980107,0.008139775,0.16262636,0.003440239,-0.012258628,0.0018881409,-0.00250785,-0.014828408,0.0884218,-0.11623618,-0.008305834,0.044840135,0.0071017654,0.016264519,5.744391E-4,0.15038198,-0.02793694,-0.008068224,-0.008599694,0.015575245,0.11691209,-0.04878837,-0.0038248447,-0.011163079,0.16194339,-0.062279288,0.105970696,0.004659379,-0.0118168695,-0.0030466425,-0.015425113,-0.04982407,-0.124726444,0.03434708,0.015633807,-0.005931374,-0.013365657,-0.0029894246,-0.010542621,-0.008841169,-9.949288E-4,2.2244983E-4,0.0031269821,-0.18969396,0.006345824,-0.031504866,-0.0017267974,-0.018963603,-0.0010683237,0.0071706832,-0.09253038,0.008546633,-0.03626304,-0.010114514,0.002729712,-0.020669943,0.017202979,0.11822446,0.017229382,0.01961838,-0.0018068346,0.0055372673,-0.013442532,0.013351278,-0.0017196975,0.0037707917,0.09495096,0.008767358,0.020306896,-0.0047233063,0.03568279,0.04886752,-0.0053666933,-0.097426474,-0.042356864,0.020983798,0.018114038,-0.016833467,0.0012267998,0.001384208,-0.07792903,0.04046457,-0.22116855,0.015876938,-0.0026273637,0.0026735114,-0.0019152412,-0.0132142855,-0.13477163,0.2580172,-0.0020056297,-0.008189668,-0.016727367,-7.310646E-5,9.561051E-4,-0.10188914,-0.006599332,-0.025356568,-0.0034298564,-0.00931767,0.004267151,-0.007153218,0.0110003315,0.013970777,-0.053425558,-3.6764763E-5,-0.0020024464,0.11138081,-0.08184803,-0.0030008066,0.068906575,-0.0103966575,-0.0020576245,0.10319442,0.01279411,-0.0019888564,7.2413066E-4,-0.13943703,-0.0023349363,0.0059071616,6.202896E-4,-0.0096310675,-0.036487676,0.033249013,-0.0175509,0.2409809,0.032654047,-0.01943071,-0.0045809383' )
    </statement>

    <statement>
        delete from pos_category where type=9
    </statement>
    <statement>insert into pos_category (_id, _mainid,seqno,title,type,level) values(21,  0, 5, 'Face', 9,1)</statement>
    <statement>insert into pos_category (_id, _mainid,seqno,title,type,level) values(22, 21, 1, 'Trump',9,2)</statement>
    <statement>insert into pos_category (_id, _mainid,seqno,title,type,level) values(23, 21, 2, 'Musk',9,2)</statement>
</sql>